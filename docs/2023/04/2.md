# KMP算法模板

> 本文编写于 2023/04/03 (CTS)

> 本文更新于 2023/04/03 (CTS)

```cpp
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
char T[1000006],S[1000006];
int n,m,nx[1000006];
void getnx()
{	nx[0]=nx[1]=0;
	for(int i=2;i<=n;i++)
	{	int p=nx[i-1];
		while(p&&S[i]!=S[p+1])p=nx[p];
		if(S[i]==S[p+1])nx[i]=p+1;
			else nx[i]=0;
	}
}
int main()
{	scanf("%s",T+1);
	scanf("%s",S+1);
	m=strlen(T+1),n=strlen(S+1);
	getnx();
	int p=0;
	for(int i=1;i<=m;i++)
	{	while(p&&T[i]!=S[p+1])p=nx[p];
		if(T[i]==S[p+1])++p;
			else p=0;
		if(p==n)printf("%d\n",i-n+1),p=nx[p];
	}
	for(int i=1;i<=n;i++)printf("%d ",nx[i]);
	printf("\n");
	return 0;
}

```
